import{r as p,j as e,m as i,n as c,l as x,B as u,a1 as y,a2 as f,v as b}from"./chunk-K5sxpyAn.js";import{D as g}from"./chunk-Dyk2dB6c.js";import{S as w}from"./chunk-C8_VK1iL.js";import{U as j,f as N,t as m}from"./index-BMfWBLPx.js";import"./chunk-DxddZhsK.js";const k={mainnet:{name:"Polygon Mainnet",chainId:137,explorerUrl:"https://polygonscan.com",rpcUrl:"https://polygon-rpc.com"}},h=()=>k.mainnet,v=t=>/^0x[a-fA-F0-9]{64}$/.test(t),T=(t,s=6,a=4)=>!t||t.length<=s+a?t:`${t.slice(0,s)}...${t.slice(-a)}`,C=(t,s)=>{if(!v(t))throw new Error("Invalid transaction hash format");const a=h();if(!a)throw new Error(`Unknown network: ${s}`);return`${a.explorerUrl}/tx/${t}`},E=(t,s)=>{try{const a=new URL(t);if(a.protocol!=="https:")throw new Error("Only HTTPS URLs are allowed");if(!["polygonscan.com","mumbai.polygonscan.com","www.polygonscan.com"].includes(a.hostname))throw new Error("URL domain not allowed");const r=["noopener=yes","noreferrer=yes","popup=yes","width=1200","height=800"].join(",");window.open(t,s||"_blank",r)}catch{throw new Error("Failed to open external link safely")}},P=t=>{try{return new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"UTC",timeZoneName:"short"})}catch{return"Invalid Date"}},F=t=>t>=1e6?`${(t/1e6).toFixed(2)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),S=async t=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(t),!0;{const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-999999px",s.style.top="-999999px",document.body.appendChild(s),s.focus(),s.select();const a=document.execCommand("copy");return document.body.removeChild(s),a}}catch{return!1}},$=({transaction:t})=>{const s=o=>{switch(o){case"order":return!0;case"payment":return t.type==="payment"||t.type==="anchor";case"anchor":return t.type==="anchor"&&t.status==="confirmed";default:return!1}},a=[{key:"order",label:"Order",completed:s("order"),icon:c},{key:"payment",label:"Payment",completed:s("payment"),icon:t.type==="payment"&&t.status==="pending"?x:c},{key:"anchor",label:"Anchor",completed:s("anchor"),icon:t.type==="anchor"&&t.status==="pending"?x:t.type==="anchor"&&t.status==="confirmed"?c:x}];return e.jsx("div",{className:"flex items-center gap-1.5 bg-slate-50 dark:bg-slate-800/50 rounded-full px-3 py-1.5 border border-slate-200 dark:border-slate-700",children:a.map((o,r)=>{const n=o.icon,d=t.type===o.key&&t.status==="pending";return e.jsxs(b.Fragment,{children:[e.jsxs(i.div,{className:"flex items-center gap-1",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:r*.1},children:[e.jsx(i.div,{animate:d?{scale:[1,1.1,1],opacity:[.7,1,.7]}:{},transition:d?{duration:1.5,repeat:1/0,ease:"easeInOut"}:{},children:e.jsx(n,{className:`w-3.5 h-3.5 ${o.completed?"text-emerald-500":d?"text-amber-500":"text-slate-400"}`})}),e.jsx("span",{className:`text-xs font-medium ${o.completed?"text-emerald-600 dark:text-emerald-400":d?"text-amber-600 dark:text-amber-400":"text-slate-500 dark:text-slate-400"}`,children:o.label})]}),r<a.length-1&&e.jsx(i.div,{className:`w-3 h-0.5 rounded-full transition-colors duration-300 ${a[r+1].completed?"bg-emerald-500":a[r+1].key===t.type&&t.status==="pending"?"bg-amber-500":"bg-slate-300 dark:bg-slate-600"}`,initial:{scaleX:0},animate:{scaleX:1},transition:{delay:(r+.5)*.1}})]},o.key)})})},D=()=>{const t=p.useMemo(()=>j.map(r=>{const n=N.find(l=>l.id===r.orderId);return{...r,buyerEmail:n?.buyerEmail||"Unknown"}}),[]),s=async r=>{try{await S(r)?m.success("Transaction hash copied to clipboard"):m.error("Failed to copy transaction hash")}catch{m.error("Failed to copy transaction hash")}},a=r=>{try{const n=C(r);E(n,`polygonscan-${r}`)}catch{m.error("Failed to open Polygonscan link")}},o=[{key:"orderId",header:"Order ID",width:"w-32",render:r=>e.jsx("span",{className:"font-mono text-sm text-blue-600",children:r})},{key:"buyerEmail",header:"Buyer Email",width:"w-48",render:r=>e.jsx("span",{className:"text-sm text-foreground",children:r})},{key:"txHash",header:"Transaction Hash",width:"w-40",render:(r,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm text-slate-600",children:T(r)}),e.jsx("button",{onClick:l=>{l.stopPropagation(),s(r)},className:"p-1 hover:bg-muted rounded transition-colors",title:"Copy full hash",children:e.jsx(y,{className:"w-3 h-3 text-slate-500"})})]})},{key:"timestamp",header:"Timestamp",width:"w-44",render:r=>e.jsx("span",{className:"text-sm text-slate-600",children:P(r)})},{key:"status",header:"Status",width:"w-28",render:r=>e.jsx(w,{status:r==="confirmed"?"completed":r==="pending"?"pending":"failed",size:"sm"})},{key:"type",header:"Type",width:"w-24",render:r=>e.jsx("span",{className:"text-sm capitalize text-slate-600",children:r})},{key:"flow",header:"Flow",width:"w-48",render:(r,n)=>e.jsx($,{transaction:n})},{key:"gasUsed",header:"Gas Used",width:"w-24",render:r=>e.jsx("span",{className:"text-sm text-slate-600",children:r?F(r):"-"})},{key:"actions",header:"Actions",width:"w-32",sortable:!1,render:(r,n)=>e.jsxs("button",{onClick:l=>{l.stopPropagation(),a(n.txHash)},className:"flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded transition-colors",title:"View on Polygonscan",children:[e.jsx(f,{className:"w-3 h-3"}),"Polygonscan"]})}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(i.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Blockchain Transactions"}),e.jsx("p",{className:"text-muted-foreground",children:"Track all blockchain transactions and their verification status on Polygon network"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-emerald-500/10 border border-emerald-500/20 rounded-2xl",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-sm font-medium text-emerald-600",children:[h().name," Connected"]})]})]})}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-card rounded-2xl border border-border/50 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:t.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-2xl flex items-center justify-center",children:e.jsx(c,{className:"w-6 h-6 text-blue-500"})})]})}),e.jsx("div",{className:"bg-card rounded-2xl border border-border/50 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Confirmed"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:t.filter(r=>r.status==="confirmed").length})]}),e.jsx("div",{className:"w-12 h-12 bg-emerald-500/10 rounded-2xl flex items-center justify-center",children:e.jsx(c,{className:"w-6 h-6 text-emerald-500"})})]})}),e.jsx("div",{className:"bg-card rounded-2xl border border-border/50 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-amber-600",children:t.filter(r=>r.status==="pending").length})]}),e.jsx("div",{className:"w-12 h-12 bg-amber-500/10 rounded-2xl flex items-center justify-center",children:e.jsx(x,{className:"w-6 h-6 text-amber-500"})})]})}),e.jsx("div",{className:"bg-card rounded-2xl border border-border/50 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold text-rose-600",children:t.filter(r=>r.status==="failed").length})]}),e.jsx("div",{className:"w-12 h-12 bg-rose-500/10 rounded-2xl flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-rose-500"})})]})})]}),e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsx(g,{data:t,columns:o,searchable:!0,sortable:!0,pagination:!0,pageSize:10,className:"shadow-xl"})})]})};export{D as default};
